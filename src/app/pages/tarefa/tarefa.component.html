<div class="tarefa-page">
  <h1>Editar tarefa</h1>

  <form [formGroup]="form" (ngSubmit)="salvar()">
    <div class="form-group">
      <label for="title">Título *</label>
      <input
        id="title"
        type="text"
        formControlName="title"
        [class.invalid]="title?.invalid && (title?.touched || title?.dirty)"
      />
      <div class="error" *ngIf="title?.errors && (title?.touched || title?.dirty)">
        <span *ngIf="title?.errors?.['required']">O título é obrigatório.</span>
        <span *ngIf="title?.errors?.['minlength']">
          O título deve ter pelo menos
          {{ title?.errors?.['minlength']?.requiredLength }} caracteres.
        </span>
      </div>
    </div>

    <div class="form-group">
      <label for="description">Descrição</label>
      <textarea id="description" rows="3" formControlName="description"></textarea>
    </div>

    <div class="form-group">
      <label for="subjectId">Disciplina *</label>
      <select
        id="subjectId"
        formControlName="subjectId"
        [class.invalid]="subjectId?.invalid && (subjectId?.touched || subjectId?.dirty)"
      >
        <option value="">Selecione...</option>
        <option *ngFor="let s of subjects" [value]="s.id">
          {{ s.name }}
        </option>
      </select>
      <div class="error" *ngIf="subjectId?.errors && (subjectId?.touched || subjectId?.dirty)">
        <span *ngIf="subjectId?.errors?.['required']">
          Selecione uma disciplina.
        </span>
      </div>
    </div>

    <div class="form-group">
      <label for="dueDate">Data de entrega *</label>
      <input
        id="dueDate"
        type="date"
        formControlName="dueDate"
        [class.invalid]="dueDate?.invalid && (dueDate?.touched || dueDate?.dirty)"
      />
      <div class="error" *ngIf="dueDate?.errors && (dueDate?.touched || dueDate?.dirty)">
        <span *ngIf="dueDate?.errors?.['required']">
          Informe uma data de entrega.
        </span>
      </div>
    </div>

    <div class="form-group">
      <label for="status">Status *</label>
      <select id="status" formControlName="status">
        <option value="pendente">Pendente</option>
        <option value="concluida">Concluída</option>
      </select>
    </div>

    <div *ngIf="error" class="error global-error">
      {{ error }}
    </div>

    <div class="actions">
      <button type="button" (click)="cancelar()">Cancelar</button>
      <button type="submit" [disabled]="loading || form.invalid">
        Salvar
      </button>
    </div>

    <div *ngIf="loading" class="loading">Salvando...</div>
  </form>
</div>
